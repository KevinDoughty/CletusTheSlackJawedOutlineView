This sample shows NSOutlineView preservation of selection and expansion state across saves and undo/redo.
It uses an NSTreeController but does not use Core Data.
It has a custom data model.
Unfortunately it makes drag and drop is difficult.